Disclaimer: this code isn't my product. It was mutual effort of few bright engineers I worked with. It was designed and used from project to project and considered this as a library.  
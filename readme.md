Disclaimer: this code isn't my product. It was mutual effort of few bright eningeers I worked with. It was designed and used from project to project and consider this as a library.  